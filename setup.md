# Інструкції для налаштування СТО проекту

## 1. Налаштування Backend (Django)

### Встановлення залежностей:
```bash
pip install -r requirements.txt
```

### Налаштування бази даних PostgreSQL:
1. Створіть базу даних PostgreSQL з назвою `sto_db`
2. Скопіюйте `env.example` в `.env` та налаштуйте змінні середовища:
   ```
   SECRET_KEY=your-secret-key-here
   DEBUG=True
   DB_NAME=sto_db
   DB_USER=postgres
   DB_PASSWORD=your-password
   DB_HOST=localhost
   DB_PORT=5432
   ```

### Виконання міграцій:
```bash
python manage.py makemigrations
python manage.py migrate
```

### Завантаження тестових даних (з підтримкою двох мов):
```bash
python manage.py load_admin_data
```

**Примітка:** Ця команда створить всі необхідні дані з підтримкою української та англійської мов:
- Адміністратора системи
- Категорії послуг (українська + англійська)
- Послуги (українська + англійська)
- Бокси (українська + англійська)
- Інформацію про СТО (українська + англійська)

### Створення суперкористувача (опціонально):
```bash
python manage.py createsuperuser
```

### Запуск сервера розробки:
```bash
python manage.py runserver
```

## 2. Налаштування Frontend (React)

### Встановлення залежностей:
```bash
cd frontend
npm install
```

### Запуск сервера розробки:
```bash
npm start
```

## 3. Доступ до системи

### Адміністратор (створюється автоматично):
- **Email:** admin@sto.com
- **Пароль:** admin123

### Звичайний користувач:
- Зареєструйтесь через форму реєстрації на сайті
- Або використовуйте email для входу в систему

## 4. Доступ до застосунку

- **Frontend**: http://localhost:3000
- **Backend API**: http://localhost:8000/api/
- **Django Admin**: http://localhost:8000/admin/

## 5. Тестування функціональності

### Багатомовність:
1. Перемикайте мову за допомогою кнопок "UA" та "US" у верхньому правому куті
2. Перевірте, що весь контент відображається відповідною мовою
3. Перевірте, що форми реєстрації та входу підтримують обидві мови

### Для гостей:
1. Відкрийте http://localhost:3000
2. Перегляньте послуги на сторінці "Послуги"
3. Запишіться на обслуговування без реєстрації
4. Перевірте відображення рекомендованих послуг на головній сторінці

### Для користувачів:
1. Зареєструйтеся або увійдіть в систему
2. Перегляньте особистий кабінет
3. Перегляньте історію обслуговування
4. Перегляньте програму лояльності

### Для адміністраторів:
1. Увійдіть як адміністратор (admin@sto.com / admin123)
2. Перейдіть в адміністративну панель
3. **Управління послугами:**
   - Додавання нових послуг (українська + англійська)
   - Редагування існуючих послуг
   - Зміна цін на послуги
   - Управління рекомендованими послугами
4. **Управління категоріями:**
   - Створення нових категорій (українська + англійська)
   - Редагування категорій
   - Встановлення порядку відображення
5. **Управління боксами:**
   - Створення нових боксів (українська + англійська)
   - Редагування боксів
   - Налаштування робочих годин
6. **Управління головною сторінкою:**
   - Редагування інформації про СТО (українська + англійська)
   - Зміна контактних даних
   - Оновлення привітального тексту
   - Управління рекомендованими послугами
7. **Управління клієнтами:**
   - Перегляд списку клієнтів
   - Блокування/розблокування клієнтів
8. **Управління записами:**
   - Підтвердження записів
   - Завершення обслуговування
9. **Статистика:**
   - Перегляд загальної статистики
   - Аналіз доходів та активності

## 6. Структура проекту

```
sto-project/
├── backend/                 # Django налаштування
│   ├── settings.py
│   ├── urls.py
│   ├── wsgi.py
│   ├── api/               # Django додаток
│   │   ├── models.py          # Моделі даних (з підтримкою _en полів)
│   │   ├── views.py           # API контролер (маршрутизація)
│   │   ├── serializers.py     # REST serializers (з підтримкою мов)
│   │   ├── data_access.py     # Шар доступу до даних
│   │   ├── urls.py            # URL конфігурація
│   │   ├── admin.py           # Адміністративна панель
│   │   └── management/        # Django команди
│   │       └── commands/
│   │           └── load_admin_data.py  # Завантаження початкових даних
│   └── services/           # Сервісний шар
│       ├── auth_service/      # Сервіс авторизації
│       ├── user_service/      # Сервіс користувачів
│       ├── appointment_service/ # Сервіс записів
│       └── service_catalog/   # Каталог послуг
├── frontend/              # React застосунок
│   ├── src/
│   │   ├── components/        # React компоненти
│   │   ├── contexts/          # React контексти (LanguageContext)
│   │   ├── translations/      # Файли перекладів
│   │   └── utils/             # Утиліти
├── requirements.txt        # Python залежності
├── manage.py              # Django management
├── env.example            # Приклад змінних середовища
└── README.md              # Документація
```

## 7. Архітектура системи

Проект реалізований згідно з C4 Model архітектурою:

### Рівень 1 (Context Diagram):
- **Клієнт** - користувач, який бажає записатися на СТО
- **Адміністратор** - керує системою, записами та послугами
- **Веб-застосунок підтримки роботи СТО** - центральна система

### Рівень 2 (Container Diagram):
- **Веб-інтерфейс** (React, JavaScript) - користувацький інтерфейс з підтримкою двох мов
- **API сервер** (Python, Django) - обробляє запити та бізнес-логіку
- **Сервіс авторизації** (Python) - керує аутентифікацією та авторизацією
- **База даних** (PostgreSQL) - зберігає дані з підтримкою багатомовності

### Рівень 3 (Component Diagram):
- **API контролер** - маршрутизація запитів
- **Сервіс користувачів** - управління обліковими записами
- **Сервіс записів** - управління записами СТО
- **Каталог послуг** - управління послугами та цінами
- **Сервіс авторизації** - аутентифікація та авторизація
- **Шар доступу до даних** - взаємодія з базою даних
- **Сервіс багатомовності** - управління перекладами

## 8. API Endpoints

### Публічні:
- `GET /api/services/` - Список послуг
- `GET /api/services/featured/` - Рекомендовані послуги
- `GET /api/sto-info/` - Інформація про СТО
- `POST /api/guest-appointments/` - Запис гостя
- `POST /api/auth/login/` - Вхід
- `POST /api/auth/register/` - Реєстрація

### Авторизовані користувачі:
- `GET /api/customers/profile/` - Профіль
- `PUT /api/customers/update_profile/` - Оновлення профілю
- `GET /api/appointments/my_appointments/` - Мої записи
- `GET /api/service-history/` - Історія обслуговування
- `GET /api/loyalty-transactions/` - Транзакції лояльності

### Адміністратори:
- `GET /api/admin/statistics/` - Статистика
- `GET /api/admin/customer_management/` - Управління клієнтами
- `POST /api/admin/{id}/block_customer/` - Блокування клієнта
- `POST /api/admin/{id}/unblock_customer/` - Розблокування клієнта
- `POST /api/appointments/{id}/confirm/` - Підтвердження запису
- `POST /api/appointments/{id}/complete/` - Завершення обслуговування
- `GET /api/admin/services_management/` - Управління послугами
- `POST /api/admin/create_service/` - Створення послуги
- `PATCH /api/admin/{id}/update_service/` - Оновлення послуги
- `DELETE /api/admin/{id}/delete_service/` - Видалення послуги
- `POST /api/admin/{id}/toggle_service_status/` - Зміна статусу послуги
- `POST /api/admin/{id}/toggle_featured_service/` - Зміна статусу рекомендованої послуги
- `GET /api/admin/categories_management/` - Управління категоріями
- `POST /api/admin/create_category/` - Створення категорії
- `PATCH /api/admin/{id}/update_category/` - Оновлення категорії
- `DELETE /api/admin/{id}/delete_category/` - Видалення категорії
- `GET /api/admin/boxes_management/` - Управління боксами
- `POST /api/admin/create_box/` - Створення боксу
- `PATCH /api/admin/{id}/update_box/` - Оновлення боксу
- `DELETE /api/admin/{id}/delete_box/` - Видалення боксу
- `GET /api/admin/home_page_management/` - Інформація про СТО
- `POST /api/admin/update_home_page/` - Оновлення інформації про СТО
- `GET /api/admin/weekly_schedule/` - Тижневий розклад

## 9. Багатомовність

### Підтримувані мови:
- **Українська** (uk) - основна мова
- **Англійська** (en) - додаткова мова

### Структура багатомовності:
- Всі моделі мають поля з суфіксом `_en` для англійської версії
- Методи `get_name()` та `get_description()` повертають відповідну мову
- React Context API керує поточною мовою
- Переклади зберігаються в `frontend/src/translations/translations.js`

### Ключові особливості:
- Автоматичне перемикання мови без перезавантаження сторінки
- Збереження вибраної мови в localStorage
- Підтримка багатомовності в адміністративній панелі
- Двоязичні форми створення та редагування 